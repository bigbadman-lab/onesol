export const TRADES_2025 = [
  {
    id: "trade_1",
    snapshot_date: "2025-01-15",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "medium",
    chart_cut_image: "chart_1_cut.png",
    chart_final_image: "chart_1_final.png",
    outcome: "RICH",
    return_pct: 245,
    reason_short: "Strong volume breakout with bullish momentum continuation",
    lesson_tag: "volume_confirmation",
  },
  {
    id: "trade_2",
    snapshot_date: "2025-01-16",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "hard",
    chart_cut_image: "chart_2_cut.png",
    chart_final_image: "chart_2_final.png",
    outcome: "RUG",
    return_pct: -95,
    reason_short: "Whale dumped liquidity immediately after initial pump",
    lesson_tag: "liquidity_trap",
  },
  {
    id: "trade_3",
    snapshot_date: "2025-01-17",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "easy",
    chart_cut_image: "chart_3_cut.png",
    chart_final_image: "chart_3_final.png",
    outcome: "RICH",
    return_pct: 180,
    reason_short: "Steady accumulation with clean support levels",
    lesson_tag: "clean_structure",
  },
  {
    id: "trade_4",
    snapshot_date: "2025-01-18",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "medium",
    chart_cut_image: "chart_4_cut.png",
    chart_final_image: "chart_4_final.png",
    outcome: "RUG",
    return_pct: -82,
    reason_short: "Low volume pump, rug pull pattern confirmed",
    lesson_tag: "low_volume_warning",
  },
  {
    id: "trade_5",
    snapshot_date: "2025-01-19",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "medium",
    chart_cut_image: "chart_5_cut.png",
    chart_final_image: "chart_5_final.png",
    outcome: "RICH",
    return_pct: 350,
    reason_short: "Massive viral momentum with sustained buying pressure",
    lesson_tag: "viral_momentum",
  },
  {
    id: "trade_6",
    snapshot_date: "2025-01-20",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "hard",
    chart_cut_image: "chart_6_cut.png",
    chart_final_image: "chart_6_final.png",
    outcome: "RUG",
    return_pct: -98,
    reason_short: "Dev wallet sold entire position at peak",
    lesson_tag: "dev_dump",
  },
  {
    id: "trade_7",
    snapshot_date: "2025-01-21",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "easy",
    chart_cut_image: "chart_7_cut.png",
    chart_final_image: "chart_7_final.png",
    outcome: "RICH",
    return_pct: 220,
    reason_short: "Strong community backing with organic growth",
    lesson_tag: "community_strength",
  },
  {
    id: "trade_8",
    snapshot_date: "2025-01-22",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "medium",
    chart_cut_image: "chart_8_cut.png",
    chart_final_image: "chart_8_final.png",
    outcome: "RUG",
    return_pct: -76,
    reason_short: "Coordinated bot activity followed by dump",
    lesson_tag: "bot_manipulation",
  },
  {
    id: "trade_9",
    snapshot_date: "2025-01-23",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "medium",
    chart_cut_image: "chart_9_cut.png",
    chart_final_image: "chart_9_final.png",
    outcome: "RICH",
    return_pct: 195,
    reason_short: "Successful breakout above key resistance with volume",
    lesson_tag: "breakout_confirmation",
  },
  {
    id: "trade_10",
    snapshot_date: "2025-01-24",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "easy",
    chart_cut_image: "chart_10_cut.png",
    chart_final_image: "chart_10_final.png",
    outcome: "RICH",
    return_pct: 285,
    reason_short: "Clear bullish pattern with high conviction entry",
    lesson_tag: "pattern_recognition",
  },
  {
    id: "trade_11",
    snapshot_date: "2025-01-25",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "hard",
    chart_cut_image: "chart_11_cut.png",
    chart_final_image: "chart_11_final.png",
    outcome: "RUG",
    return_pct: -91,
    reason_short: "Fake volume spike masked sell pressure",
    lesson_tag: "fake_volume",
  },
  {
    id: "trade_12",
    snapshot_date: "2025-01-26",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "medium",
    chart_cut_image: "chart_12_cut.png",
    chart_final_image: "chart_12_final.png",
    outcome: "RICH",
    return_pct: 310,
    reason_short: "Perfect entry timing on trend reversal",
    lesson_tag: "reversal_timing",
  },
  {
    id: "trade_13",
    snapshot_date: "2025-01-27",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "easy",
    chart_cut_image: "chart_13_cut.png",
    chart_final_image: "chart_13_final.png",
    outcome: "RICH",
    return_pct: 165,
    reason_short: "Gradual accumulation with stable price action",
    lesson_tag: "stable_accumulation",
  },
  {
    id: "trade_14",
    snapshot_date: "2025-01-28",
    timeframe: "15m",
    cut_type: "early_signal",
    difficulty: "hard",
    chart_cut_image: "chart_14_cut.png",
    chart_final_image: "chart_14_final.png",
    outcome: "RUG",
    return_pct: -88,
    reason_short: "Honeypot contract detected post-launch",
    lesson_tag: "contract_risk",
  },
  {
    id: "trade_15",
    snapshot_date: "2025-01-29",
    timeframe: "15m",
    cut_type: "mid_move",
    difficulty: "medium",
    chart_cut_image: "chart_15_cut.png",
    chart_final_image: "chart_15_final.png",
    outcome: "RICH",
    return_pct: 275,
    reason_short: "Strong whale accumulation with price support",
    lesson_tag: "whale_accumulation",
  },
];

// Game constants
export const STARTING_BALANCE = 10.0;
export const BET_OPTIONS = [0.25, 1.0, 3.0];

// Calculate PNL cap from dataset
const maxPositiveReturn = Math.max(
  ...TRADES_2025.filter((t) => t.outcome === "RICH").map((t) => t.return_pct),
);
export const PNL_CAP = maxPositiveReturn / 100; // 350 / 100 = 3.5

// Helper function to get trade by ID
export function getTradeById(id) {
  return TRADES_2025.find((trade) => trade.id === id);
}

// Helper function to calculate PNL
export function calculatePNL(betAmount, prediction, actualOutcome, returnPct) {
  const isCorrect = prediction === actualOutcome;

  if (isCorrect) {
    const mult = Math.min(Math.abs(returnPct) / 100, PNL_CAP);
    return parseFloat((betAmount * mult).toFixed(2));
  } else {
    return parseFloat((-betAmount).toFixed(2));
  }
}

// Helper function to get random trade for endless mode
let shuffledTrades = [...TRADES_2025];
let currentShuffleIndex = 0;

export function getRandomTrade(excludeIds = []) {
  if (currentShuffleIndex >= shuffledTrades.length) {
    // Reshuffle when exhausted
    shuffledTrades = [...TRADES_2025].sort(() => Math.random() - 0.5);
    currentShuffleIndex = 0;
  }

  let trade = shuffledTrades[currentShuffleIndex];
  currentShuffleIndex++;

  // If this trade is in excludeIds, try next one
  if (excludeIds.includes(trade.id)) {
    return getRandomTrade(excludeIds);
  }

  return trade;
}

export function resetRandomTradeGenerator() {
  shuffledTrades = [...TRADES_2025].sort(() => Math.random() - 0.5);
  currentShuffleIndex = 0;
}
